ğŸª Cookies & Sessions in HTTP â€“ Detailed & Deep Dive

ğŸ” What Are Cookies?
                    Cookies are small keyvalue data pieces stored on 
                    the client (browser) that the server can set, 
                    read, and update.
                    
                    They are used to maintain state across HTTP 
                    requests (which are stateless by default).
                    
                    Each cookie is attached in every request to the 
                    origin server
ğŸŒ Why Do We Need Cookies?
ğŸ”¸ Problem:
HTTP is "stateless" â€“ the server forgets who you are between two 
requests.

ğŸ”¸ Solution:
            Cookies can remember things like:
            Who you are (authentication/session)
            Your preferences (dark mode, language)
            Items in your cart
            Analytics tracking (Google Analytics, etc.)

ğŸ§  Cookie Anatomy
When a server sets a cookie, it sends it in the response:
        SetCookie: sessionid=abc123; Path=/; HttpOnly; Secure; MaxAge=3600

  KEY COMPONENTS OF THE COOKIE:
   Attribute              Meaning                                  
   `Name=Value`           Actual data (e.g., `sessionid=abc123`) 
   `Path`                 URL path where cookie is valid         
   `Domain`               Scope across subdomains                
   `Expires` / `MaxAge`  When the cookie expires                
   `HttpOnly`             JS cannot access (XSS protection)      
   `Secure`               Only sent over HTTPS                   
   `SameSite`             Protect against CSRF                   




ğŸ” What Is a Session?
A session is a server-side concept used to store user data 
(e.g., login state, cart items).

When you log in, the server creates a session (e.g., in memory or 
Redis).
It returns a session ID stored as a cookie in the client.
On future requests, the session ID is sent with the cookie.
The server reads the session ID and fetches associated data.


  SESSION LIFE CYCLE
+---------+                              +---------------------+
|         |  1. Login Request (POST)     |                     |
| Client  |----------------------------->|      Server         |
| (User)  |   { username, password }     |                     |
+---------+                              +---------------------+
                                               |
                                               | 2. Authenticate user
                                               | 3. Create server-side session
                                               |    sessionid = "abc123"
                                               V
                                      +----------------------------+
                                      | Server Session Store       |
                                      | sessionid=abc123           |
                                      | { userID: 42, role: admin }|
                                      +----------------------------+
                                               |
                                               | 4. Set-Cookie in response
                                               V
+---------+   <-----------------------------+---------------------+
|         |                                 |                     |
| Client  |  Set-Cookie: sessionid=abc123   |      Server         |
|         |-------------------------------->|                     |
+---------+                                 +---------------------+

   ğŸ” Now for every future request:

+---------+                              +---------------------+
|         |                              |                     |
| Client  |                              |      Server         |
|         |  Cookie: sessionid=abc123    |                     |
|         |----------------------------->| 5. Reads session ID |
|         |                              |    from cookie      |
+---------+                              |                     |
                                          | Looks up session:
                                          | sessionid=abc123
                                          | userID = 42
                                          V
                                   Return response (user info, etc.)

  
WHAT HAPPENING ?                                                       |
| 1ï¸âƒ£  | User logs in by sending credentials to server (`/login`)           |
| 2ï¸âƒ£  | Server authenticates credentials                                   |
| 3ï¸âƒ£  | Server creates a **session entry** in memory/DB with a `sessionid` |
| 4ï¸âƒ£  | Server sends a `Set-Cookie: sessionid=abc123` back to the client   |
| 5ï¸âƒ£  | Client stores cookie and sends it on every future request          |
| 6ï¸âƒ£  | Server reads cookie, fetches session info, processes the request   |

EXAMPLE:
1. ğŸ‘¤ User logs in
      POST /login
      Body: { username, password }

2. âœ… Server creates a session
      sessionID := generateUUID()
      sessions[sessionID] = {userID: 42, loggedIn: true}

3. ğŸª Server sets a cookie
      Set-Cookie: sessionid=abc123; Path=/; HttpOnly; Secure

4. ğŸ§¾ Client stores cookie, automatically sends it in future
      GET /profile
      Cookie: sessionid=abc123


  IN GOLANG :
âš™ï¸ In Go (Gin + gorilla/sessions)

store := sessions.NewCookieStore([]byte("secret"))
r.GET("/login", func(c *gin.Context) {
    session, _ := store.Get(c.Request, "sessionid")
    session.Values["authenticated"] = true
    session.Save(c.Request, c.Writer)
})


| Feature       | Cookies (Client-side)                     | Sessions (Server-side)                   |
| ------------- | ----------------------------------------- | ---------------------------------------- |
| Stored in     | Browser                                   | Server memory / DB / Redis               |
| Size limit    | \~4 KB                                    | Much larger                              |
| Security risk | Vulnerable to XSS if `HttpOnly` not set   | Safer (data not exposed to browser)      |
| Persistence   | Survives browser close if `Expires` set   | Often reset on logout or timeout         |
| Performance   | Lightweight but user data goes back/forth | Faster (just session ID sent back/forth) |

ğŸ§  Real-Time Use Cases
Feature	Explanation
                ğŸ›’ Shopping cart	Store cart in session
                ğŸ‘¨â€ğŸ’¼ Logged-in user	Session holds user info
                ğŸŒ Language preference	Cookie stores lang=en
                ğŸ“ˆ Analytics tracking	Cookie stores user ID for analytics

ğŸ“‚ Cookie Storage Locations
            Browser	  Where cookies are stored
            Chrome	  DevTools â†’ Application â†’ Cookies
            Firefox	  about:preferences#privacy
            CLI	      curl: --cookie and --cookie-jar options
  
ğŸ›¡ï¸ Security Considerations
        1. âœ… Set HttpOnly
            Prevents JS from reading the cookie â†’ protects against
            XSS attacks.
        
        2. âœ… Set Secure
            Ensures the cookie is only sent over HTTPS â†’ protects against 
            man-in-the-middle attacks.
        
        3. âœ… Set SameSite=Strict/Lax
            Helps prevent CSRF (Cross-Site Request Forgery).
        
        4. âŒ Donâ€™t store sensitive data in cookies
          Cookies can be modified on the client side. 
          Store only a session ID, not passwords, roles, etc.
